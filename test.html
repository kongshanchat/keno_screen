<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>科诺大屏</title>
    <link rel="stylesheet" type="text/css" href="./css/base.css">
    <link rel="stylesheet" type="text/css" href="./css/swiper.min.css">
    <link rel="stylesheet" type="text/css" href="./css/certify.css">
    <link href="./lib/bg/css/index_style.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" href="./css/common.css">
    <link rel="stylesheet" type="text/css" href="./css/wavecircle.css">

    <script src="./js/jquery-1.12.2.min.js"></script>

    <script src="./js/common.js"></script>
    <script src="./js/swiper.min.js"></script>
    <script src="./js/num.js"></script>
    <script src="./js/num2.js"></script>
    <script src="./js/num3.js"></script>
    <script src="./js/lottie.js"></script>

    <script src="../../common/js/WebCore.js"></script>
</head>

<body>
    <!-----HEADER STAR----->
    <div class="header">
        <div id="container">
            <header>
                <time id="headerTime"></time>
            </header>


            <main>
                <!--主左侧模块BG-->
                <div class="l main_item">
                    <div class="box_item jiya top_margin">
                        <div class="box-tle">
                            挤压车间
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l jiya_l">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle sumRate">
                                            <span>挤压车间的总达成率</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>

                                        </div>
                                        <div class="chartCont circlecont">
                                            <div class="circleChart" id="0">
                                                <p>#一线</p>
                                            </div>
                                            <div class="circleChart" id="1">
                                                <p>#二线</p>
                                            </div>
                                            <div class="circleChart" id="2">
                                                <p>#三线</p>
                                            </div>
                                            <div class="circleChart" id="3">
                                                <p>#四线</p>
                                            </div>
                                            <div class="circleChart" id="4">
                                                <p>#五线</p>
                                            </div>
                                            <div class="circleChart" id="5">
                                                <p>#六线</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- chartBox_item -->
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle jiya_chejian">
                                            <span>挤压车间工单</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                    </div>
                                    <div class="chartBox_b">
                                        <div id="jiya_charts"></div>
                                    </div>

                                </div>
                                <!-- chartBox_item -->
                            </div>
                            <!-- chartBox_l -->


                            <div class="chartBox_r">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle">
                                            挤压车间设备实时状态

                                        </div>
                                        <div class="chartCont">
                                            <div class="statusBox">
                                                <div class="tr">
                                                    <div class="td">编号</div>
                                                    <div class="td">设备名称</div>
                                                    <div class="td">当前状态</div>
                                                </div>
                                                <div id="live_status" style="height:252px;overflow:hidden">

                                                    <!-- <div class="tr">
                                                    <div class="td">6</div>
                                                    <div class="td">哈哈哈</div>
                                                    <div class="td">3是</div>
                                                </div> -->

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chartBox_b">

                                    </div>
                                </div>
                                <!-- chartBox_item -->
                            </div>
                            <!-- chartBox_r -->
                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->

                    <!-- 氧化车间 BG -->
                    <div class="box_item">
                        <div class="box-tle">
                            氧化车间
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l yanghua_l">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle yanghua_chejian">
                                            <span>氧化车间生产工单</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div id="RateWorkOrderChart"></div>
                                        </div>
                                    </div>


                                </div>

                            </div>
                            <!-- chartBox_l -->


                            <div class="chartBox_r yanghua_r">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle">
                                            工单达成率合格率
                                        </div>
                                        <div class="chartCont">
                                            <div id="workOrderChart"></div>
                                        </div>
                                    </div>

                                </div>
                                <!-- chartBox_item -->
                            </div>
                            <!-- chartBox_r -->
                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->
                    <!-- 氧化车间 ED -->

                    <!-- 深加工车间 BG -->
                    <div class="box_item">
                        <div class="box-tle">
                            深加工车间
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l produce">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle qualifyRate" style="margin-bottom: 0">
                                            <span>生产工单达成率</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div id="produceOrderChartRate"></div>
                                        </div>
                                    </div>

                                    <div class="chartBox_b">
                                        <div class="chart_tle produce_rate" style="margin-bottom: 0">
                                            <span>生产工单完工数</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div id="produceOrderChartDoneRate"></div>
                                        </div>
                                    </div>


                                </div>

                            </div>
                            <!-- chartBox_l -->

                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->
                    <!-- 深加工车间 ED -->

                </div>
                <!--  主左侧模块ED -->


                <!-- 主中间侧模块BG -->
                <div class=" c main_item">
                    <div class="top_icons">
                        <img src="./images/topgroup.png" class="c_top_left">
                        <img src="./images/topgroup.png" class="c_top_right">
                    </div>

                    <!-- 数字翻页 BG -->
                    <div class="nubberBox">
                        <div class="number_item">
                            <p>计划数量:</p>
                            <div id="dataNums1">
                                <div class="numberBox">
                                    <p>6</p>
                                    <p>6</p>
                                    <p>6</p>
                                    <p>1</p>
                                    <p>1</p>
                                    <p>1</p>
                                    <span>只</span>
                                </div>
                            </div>
                        </div>
                        <div class="number_item">
                            <p>完工数量:</p>
                            <div id="dataNums2">
                                <div class="numberBox">
                                    <p>0</p>
                                    <p>0</p>
                                    <p>0</p>
                                    <p>0</p>
                                    <p>0</p>
                                    <p>0</p>
                                    <span>只</span>
                                </div>
                            </div>
                        </div>
                        <div class="number_item">
                            <p>合格数量:</p>
                            <div id="dataNums3">
                                <div class="numberBox">
                                    <p>0</p>
                                    <p>4</p>
                                    <p>6</p>
                                    <p>2</p>
                                    <p>8</p>
                                    <p>1</p>
                                    <span>只</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 数字翻页 END -->

                    <!-- 数据轮播 BG -->
                    <div class="swiperItem">
                        <div id="certify">
                            <div class="swiper-container">
                                <div class="swiper-wrapper bgwrapper">
                                    <div class="swiper-slide jiya">
                                        <p>挤压车间</p>
                                        <img src="./images/worker.png" class="bg1">
                                        <img src="./images/workerdown.png" class="bg2">

                                        <span class="ball1">#1</span>
                                        <span class="ball2">#2</span>
                                        <span class="ball3">#3</span>
                                        <span class="ball4">#4</span>
                                        <span class="ball5">#5</span>
                                        <span class="ball6">#6</span>
                                    </div>
                                    <div class="swiper-slide deep">
                                        <p>深加工车间</p>
                                        <img src="./images/process.png" class="bg1">
                                        <img src="./images/processBg.png" class="bg2">
                                        <img src="./images/process_circle.png" class="bg3">
                                        <img src="./images/down2.png" class="bg4">

                                    </div>
                                    <div class="swiper-slide youyang">
                                        <p>氧化车间</p>
                                        <img src="./images/process2.png" class="bg1">
                                        <img src="./images/processBg.png" class="bg2">
                                        <img src="./images/processcircle.png" class="bg3">
                                        <img src="./images/down2.png" class="bg4">
                                    </div>

                                </div>
                            </div>
                            <!-- <div class="swiper-pagination"></div> -->
                            <div class="swiper-button-prev"></div>
                            <div class="swiper-button-next"></div>
                        </div>

                    </div>
                    <div class="down_pic">
                        <img src="./images/down3.png">
                        <img src="./images/arrow.png" class="arrow">
                        <img src="./images/arrow2.png" class="arrow2">
                        <div class="svgBox">

                            <div style="width:300px;height:400px" id="bodymovin"></div>
                        </div>

                    </div>
                    <!-- 数据轮播 END -->

                    <!-- 生产统计 BG -->
                    <div class="box_item" style="margin-top: 6px;">
                        <div class="box-tle">
                            生产统计
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l produce">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chartCont">
                                            <p class="live_status_title">生产总汇占比</p>
                                            <div class="live_status produceRate">
                                                <!-- <div class="status_items">
                                                    <div class="green8">
                                                        <div class="progress">
                                                            <div class="inner">
                                                                <div class="percent number"><span>67</span>%</div>
                                                                <div class="water"></div>
                                                                <div class="glare"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="status_text">
                                                        <p>#时尚线</p>
                                                        <p class="number">136<span></span></p>
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chartBox_b">
                                        <div class="chart_tle process_static">
                                            <span>生产进度统计</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div id="statisticChart"></div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <!-- chartBox_l -->

                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->
                    <!-- 生产统计 ED -->

                </div>
                <!-- <!-- 主中间模块ED -->-->

                <!-- 主右侧模块BG -->
                <div class="r main_item">

                    <!-- 仓库实时库存 BG -->
                    <div class="box_item top_margin">
                        <div class="box-tle">
                            仓库实时库存
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l yanghua_l">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle materialHouse">
                                            <span>原料仓库</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div class="material" id="marterialHouse">
                                                <!-- <div class="material_item">
                                                    <p>璐定</p>
                                                    <div class="desc">
                                                        <p>当前库存：<span>1200</span><span>吨</span></p>
                                                        <p>今日入库：<span class="curDay">1200</span><span>吨</span></p>
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>


                                </div>

                            </div>
                            <!-- chartBox_l -->


                            <div class="chartBox_r yanghua_r">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle materialHouse">

                                            <span>成品仓库</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div class="material" id="finishGoods">
                                                <!-- <div class="material_item">
                                                    <img src="./images/topline.png" class="topline">
                                                    <img src="./images/rect2.png" class="rectLeft">
                                                    <img src="./images/rect2.png" class="rectRight">
                                                    <img src="./images/rect2.png" class="rectLeftBottom">
                                                    <img src="./images/rect2.png" class="rectRightBottom">
                                                    <div class="desc">
                                                        <div>当前库存量:</div>
                                                        <div>3000<span>吨</span></div>
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <!-- chartBox_item -->
                            </div>
                            <!-- chartBox_r -->
                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->
                    <!-- 仓库实时库存 ED -->


                    <!-- 仓库周发货计划 BG -->
                    <div class="box_item">
                        <div class="box-tle">
                            仓库周发货计划
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l yanghua_l">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle jihuaWangong">
                                            <span>周发货计划完工数</span>
                                            <p class="line_l"></p>
                                            <p class="line_r"></p>
                                        </div>
                                        <div class="chartCont">
                                            <div id="weekPlanDoneChart"></div>
                                        </div>
                                    </div>


                                </div>

                            </div>
                            <!-- chartBox_l -->


                            <div class="chartBox_r yanghua_r">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chart_tle">
                                            周发货达成率
                                        </div>
                                        <div class="chartCont">
                                            <div id="weeksendDoneChart"></div>
                                        </div>
                                    </div>

                                </div>
                                <!-- chartBox_item -->
                            </div>
                            <!-- chartBox_r -->
                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->
                    <!-- 仓库周发货计划 ED -->


                    <!-- 氮化炉实时监控 BG -->
                    <div class="box_item">
                        <div class="box-tle">
                            氮化炉实时监控
                        </div>
                        <!-- box-tle -->

                        <div class="chartBox">
                            <img src="./images/rect.png" class="rectLeft">
                            <img src="./images/rect.png" class="rectRight">
                            <img src="./images/rect.png" class="rectLeftBottom">
                            <img src="./images/rect.png" class="rectRightBottom">
                            <div class="chartBox_l produce">
                                <div class=" chartBox_item">
                                    <div class="chartBox_t">
                                        <div class="chartCont">
                                            <div class="live_status live_status2">


                                                <!-- <div class="status_item">
                                                    <div class="status_l">
                                                        <span>水循环状态</span>
                                                        <p>正常</p>
                                                    </div>
                                                    <div class="status_r">
                                                        <img src="./images/water.png">
                                                    </div>
                                                </div> -->
                                            </div>
                                        </div>
                                    </div>
                                    <div class="chartBox_b">
                                        <div class="chartCont">
                                            <div class="charttable">
                                                <div class="table_thead">
                                                    <div class="table_th">编号</div>
                                                    <div class="table_th">模具编号</div>
                                                    <div class="table_th">模号</div>
                                                    <div class="table_th">煲模开始时间</div>
                                                    <div class="table_th">煲模截止时间</div>
                                                    <div class="table_th">煲模时长</div>
                                                </div>
                                                <div class="model_table">
                                                    <!-- <div class="table_tr">
                                                    <div class="table_td">1</div>
                                                    <div class="table_td">132sfsf</div>
                                                    <div class="table_td">1</div>
                                                    <div class="table_td">2019-07-01 12:00</div>
                                                    <div class="table_td">2019-07-01 12:00</div>
                                                    <div class="table_td">10小时00分钟</div>
                                                </div> -->
                                                </div>
                                            </div>


                                        </div>
                                    </div>
                                </div>

                            </div>
                            <!-- chartBox_l -->

                        </div>
                        <!-- chartBox -->
                    </div>
                    <!-- box_item -->
                    <!-- 氮化炉实时监控 ED -->

                </div>
                <!-- 主右侧模块ED -->
            </main>
        </div>
        <!-- container -->
        <!-- <div class="canvaszz"> </div> -->
        <canvas id="canvas" style="height: 2160px"></canvas>
    </div>
    <!-----HEADER END----->
    <div class="videozz"></div>

    <script src="./js/echarts.js"></script>
    <script src="./lib/circleChart.min.js"></script>
    <script src="./lib/bg/js/bg.js"></script>

    <script src="./js/ec.js"></script>
    <script src="./js/index.js"></script>

    <!-- <script src="./js/jquery.waypoints.min.js"></script>
    <script src="./js/jquery.countup.min.js"></script> -->
    <script>
        //var ch = $(window).height();
        //$('main').height(ch);

        //$('.counter').countUp();


        $(function () {

        });


        //svg 动画 引入
        var animData = {
            wrapper: document.getElementById('bodymovin'),
            animType: 'html',
            loop: true,
            prerender: true,
            autoplay: true,
            path: 'data3.json'

        };
        var anim = bodymovin.loadAnimation(animData);

        //svg 动画 引入end//

        //达成率
        function doneRateMove() {
            var rateColor = ['#389AF4', '#FF872E', '#FFC257', '#FD6892', '#A100FC', '#03D7FB']
            var rateColor2 = ['rgba(56, 154, 244, .3)', 'rgba(255, 135, 46, .3)', 'rgba(255, 194, 87, .3)',
                'rgba(253, 104, 146, .3)', 'rgba(161, 0, 252, .3)', 'rgba(3, 215, 251, .3)'
            ]
            //ajax获取个产线达成率
            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryDoneRateByDay"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    var doneRate = data;
                    for (let i = 0; i < 6; i++) {
                        $(".circleChart#" + i).circleChart({
                            size: 62,
                            value: doneRate[i].value,
                            text: 0,
                            backgroundColor: rateColor2[i],
                            color: rateColor[i],
                            onDraw: function (el, circle) {
                                circle.text((circle.value).toFixed(2) + "%");
                            }
                        });
                    }
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }

        doneRateMove()

        //每隔6秒刷新一次达成率
        setInterval(function () {
            doneRateMove()
        }, 300000);
        //达成率 end //


        //挤压实时状态 滚动
        function getJiyaData() {
            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryDevState"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    var deviceStatus = data;
                    addJiyaHtml(deviceStatus)
                },
                error: function (e) {
                    //console.log(e); 
                }
            });
        }

        function addJiyaHtml(deviceStatus) {
            var _statusHtml = '';
            //返回数据不为空时
            if (deviceStatus != null && deviceStatus.length > 0) {
                $.each(deviceStatus, function (a, b) {
                    if (deviceStatus[a].curStatus == 0) {
                        _statusHtml += `
                        <div class="tr status_stop">
                            <div class="td">${a+1}</div>
                            <div class="td">${deviceStatus[a].deviceName}</div>
                            <div class="td">暂停</div>
                        </div>
                        `
                    } else if (deviceStatus[a].curStatus == 1) {
                        _statusHtml += `
                        <div class="tr status_act">
                            <div class="td">${deviceStatus[a].sno}</div>
                            <div class="td">${deviceStatus[a].deviceName}</div>
                            <div class="td">运行</div>
                        </div>
                        `
                    } else if (deviceStatus[a].curStatus == 2) {
                        _statusHtml += `
                        <div class="tr status_repaire">
                            <div class="td">${deviceStatus[a].sno}</div>
                            <div class="td">${deviceStatus[a].deviceName}</div>
                            <div class="td">维修</div>
                        </div>`
                    }

                })
            }

            $('#live_status').html(_statusHtml)
        }

        getJiyaData()

        var _wrap = $('#live_status'); //定义滚动区域
        var _interval = 3000; //定义滚动间隙时间
        var _moving; //需要清除的动画
        _wrap.hover(function () {
            clearInterval(_moving); //当鼠标在滚动区域中时,停止滚动
        }, function () {
            _moving = setInterval(function () {
                var _field = _wrap.find('.tr:first'); //此变量不可放置于函数起始处，li:first取值是变化的
                var _h = _field.height(); //取得每次滚动高度
                _field.animate({
                    marginTop: -_h + 'px'
                }, 600, function () { //通过取负margin值，隐藏第一行
                    _field.css('marginTop', 0).appendTo(
                        _wrap); //隐藏后，将该行的margin值置零，并插入到最后，实现无缝滚动
                })
            }, _interval) //滚动间隔时间取决于_interval
        }).trigger('mouseleave'); //函数载入时，模拟执行mouseleave，即自动滚动

        //大屏中间轮播数据
        function getMidData() {
            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryMidInfo"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    lunbo(data)
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }


        function lunbo(data2) {
            // 大屏中间轮播 begain
            var certifySwiper = new Swiper('#certify .swiper-container', {
                watchSlidesProgress: true,
                slidesPerView: 'auto',
                centeredSlides: true,
                loop: true,
                loopedSlides: 3,
                autoplay: 6000,
                prevButton: '.swiper-button-prev',
                nextButton: '.swiper-button-next',
                //pagination: '.swiper-pagination',
                //paginationClickable :true,
                onProgress: function (swiper, progress) {
                    //console.log(certifySwiper)
                    for (i = 0; i < swiper.slides.length; i++) {
                        var slide = swiper.slides.eq(i);
                        var slideProgress = swiper.slides[i].progress;
                        modify = 1;
                        if (Math.abs(slideProgress) > 1) {
                            modify = (Math.abs(slideProgress) - 1) * 0.3 + 1;
                        }
                        translate = slideProgress * modify * 100 + 'px';
                        scale = 1 - Math.abs(slideProgress) / 5;
                        zIndex = 999 - Math.abs(Math.round(10 * slideProgress));
                        slide.transform('translateX(' + translate + ') scale(' + scale + ')');
                        slide.css('zIndex', zIndex);
                        slide.css('opacity', 1);
                        if (Math.abs(slideProgress) > 3) {
                            slide.css('opacity', 0);
                        }
                    }

                    if (swiper.activeIndex == 3) {
                        setPageNumber(data2.jiagong)
                    } else if (swiper.activeIndex == 4) {
                        setPageNumber(data2.yanghua)
                    } else if (swiper.activeIndex == 5) {
                        setPageNumber(data2.jiya[0])
                    } else if (swiper.activeIndex == 3) {
                        setPageNumber(data2.jiagong)
                    }
                },
                onSetTransition: function (swiper, transition) {
                    for (var i = 0; i < swiper.slides.length; i++) {
                        var slide = swiper.slides.eq(i)
                        slide.transition(transition);
                    }

                },
                //处理分页器bug
                onSlideChangeStart: function (swiper) {
                    //console.log(swiper)
                    $('.bgwrapper .jiya span').removeClass('activeBall')
                    ac_index = swiper.activeIndex;
                    if (swiper.activeIndex == 4) {
                        //swiper.bullets.eq(9).addClass('swiper-pagination-bullet-active');
                        //console.log(swiper.bullets.length);
                    }
                    if (swiper.activeIndex == 3 || swiper.activeIndex == 6) {
                        if (certifySwiper !== undefined) {
                            certifySwiper.stopAutoplay();
                            startsAutoPlay(data2);
                            setTimeout(function () {
                                clearInterval(timer);
                                certifySwiper.startAutoplay();
                            }, 36000)
                        }
                    }
                }
            });

        }


        //小球抖动停止
        function ballBounce() {
            clearInterval(timer);
            lunbo.certifySwiper.startAutoplay();
        }


        var timer = null;


        //轮播到挤压车间 停止当前轮播 小球跳动
        function startsAutoPlay(data2) {
            var index = 0;
            $('.ball1').addClass('activeBall')
            timer = setInterval(function () {
                index++;
                if (index > 6) {
                    index = 0;
                }
                changeBalls(index, data2); //小球跳动
            }, 6000);
        }

        function changeBalls(index, data2) {
            var balls = $('.bgwrapper .jiya span');
            for (var i = 0; i < balls.length; i++) {
                $(balls[i]).addClass('ballsss' + i);
                $(balls[i]).removeClass('activeBall')
            }
            setPageNumber(data2.jiya[index]);


            $(balls[index + 12]).addClass('activeBall')
        }

        function setPageNumber(data) {

            $("#dataNums1").rollNumDaq({
                deVal: data.plan
            });

            $("#dataNums2").rollNumDaq2({
                deVal: data.done
            });

            $("#dataNums3").rollNumDaq3({
                deVal: data.quality
            });
        }
        //初识页面调用
        getMidData()

        //原料仓库
        function getMaterialData() {
            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryLarScrMaterial"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    addMaterialHtml(data);
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }

        function addMaterialHtml(data) {
            var materialHtml = '';
            $.each(data, function (a, b) {
                materialHtml += `
                <div class="material_item">
                    <p>${data[a].name}</p>
                    <div class="desc">
                        <p>当前库存：<span>${data[a].inventory}</span><span>吨</span></p>
                        <p>今日入库：<span class="curDay">${data[a].wareHouse}</span><span>吨</span></p>
                    </div>
                </div>`
            })

            $('#marterialHouse').html(materialHtml)
        }


        getMaterialData()



        //成品仓库

        function getFinshGoodsData() {

            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryLarScrProduct"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    addFinishGoodsHtml(data);
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }

        function addFinishGoodsHtml(data) {
            var FinishGoodsHtml = '';
            $.each(data, function (a, b) {
                FinishGoodsHtml += `
                <div class="material_item">
                    <img src="./images/topline.png" class="topline">
                    <img src="./images/rect2.png" class="rectLeft">
                    <img src="./images/rect2.png" class="rectRight">
                    <img src="./images/rect2.png" class="rectLeftBottom">
                    <img src="./images/rect2.png" class="rectRightBottom">

                    <div class="desc">
                        <div>${data[a].title}:</div>
                        <div>${data[a].value}<span>吨</span></div>
                    </div>
                </div>`
            })

            $('#finishGoods').html(FinishGoodsHtml)
        }


        getFinshGoodsData()

        //氮化炉实时监控

        function getLiveData() {
            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryLarScrNitridingFurnace"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    addLiveHtml(data)
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }

        function addLiveHtml(data) {
            var LiveHtml = '';
            $.each(data, function (a, b) {
                if (a == 0) {
                    LiveHtml += `
                    <div class="status_item live_0">
                        <div class="status_l">
                            <span>${data[a].title}</span>
                            <p>${data[a].value}%</p>
                        </div>
                        <div class="status_r">
                            <img src="./images/rate.png">
                        </div>
                    </div> `

                } else if (a == 1) {
                    LiveHtml += `
                    <div class="status_item live_1">
                        <div class="status_l">
                            <span>${data[a].title}</span>
                            <p>${data[a].value}m³/h</p>
                        </div>
                        <div class="status_r">
                            <img src="./images/liuliang.png">
                        </div>
                    </div> `
                } else if (a == 2) {
                    LiveHtml += `
                    <div class="status_item live_2">
                        <div class="status_l">
                            <span>${data[a].title}</span>
                            <p>${data[a].value}℃</p>
                        </div>
                        <div class="status_r">
                            <img src="./images/temper.png">
                        </div>
                    </div> `
                } else if (a == 3) {
                    LiveHtml += `
                    <div class="status_item live_3">
                        <div class="status_l">
                            <span>${data[a].title}</span>
                            <p>${data[a].value}</p>
                        </div>
                        <div class="status_r">
                            <img src="./images/water.png">
                        </div>
                    </div> `
                }
            })

            $('.live_status2').html(LiveHtml)
        }


        getLiveData();

        //煲模表格
        function getModelData() {

            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryLarScrPotMold"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    addModelHtml(data)
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }

        function addModelHtml(data) {
            var modelHtml = '';
            $.each(data, function (a, b) {
                modelHtml += `
                <div class="table_tr">
                    <div class="table_td">${a+1}</div>
                    <div class="table_td">${data[a].sno}</div>
                    <div class="table_td">${data[a].model_num}</div>
                    <div class="table_td">${data[a].begain_time}</div>
                    <div class="table_td">${data[a].end_time}</div>
                    <div class="table_td">${data[a].duration}</div>
                </div>`
            })

            $('.model_table').html(modelHtml)
        }

        var _wrap2 = $('.model_table'); //定义滚动区域
        var _interval2 = 3000; //定义滚动间隙时间
        var _moving2; //需要清除的动画
        _wrap2.hover(function () {
            clearInterval(_moving2); //当鼠标在滚动区域中时,停止滚动
        }, function () {
            _moving2 = setInterval(function () {
                var _field = _wrap2.find('.table_tr:first'); //此变量不可放置于函数起始处，li:first取值是变化的
                var _h = _field.height(); //取得每次滚动高度
                _field.animate({
                    marginTop: -_h + 'px'
                }, 600, function () { //通过取负margin值，隐藏第一行
                    _field.css('marginTop', 0).appendTo(
                        _wrap2); //隐藏后，将该行的margin值置零，并插入到最后，实现无缝滚动
                })
            }, _interval2) //滚动间隔时间取决于_interval
        }).trigger('mouseleave'); //函数载入时，模拟执行mouseleave，即自动滚动


        getModelData()


        //生产汇总占比
        function getproduceRateData() {

            $.ajax({
                type: "get",
                url: WebCore.root("/material/bigScreen/queryLarScrProductionSummary"),
                contentType: 'application/x-www-form-urlencoded;charset=utf-8',
                data: {

                },
                dataType: "json",
                success: function (data) {
                    addRateHtml(data);
                },
                error: function (e) {
                    //console.log(e);
                }
            });
        }

        function addRateHtml(data) {
            var rateHtml = '';
            $.each(data, function (a, b) {
                rateHtml += `
                <div class="status_items">
                    <div class="green${a+1}">
                        <div class="progress">
                            <div class="inner">
                                <div class="percent number"><span>${data[a].rate}</span>%</div>
                                <div class="water" style="top:${100 - data[a].rate}%"></div>
                                <div class="glare"></div>
                            </div>
                        </div>
                    </div>
                    <div class="status_text status_text${a+1}">
                        <p>${data[a].name}</p>
                        <p class="number">${data[a].num}<span>支</span></p>
                    </div>
                </div>
                `
            })

            $('.produceRate').html(rateHtml)
        }

        getproduceRateData();


        //所有非echarts图表的数据定时刷新  
        //直接调用函数

        setInterval(function () {
            doneRateMove();
            getJiyaData();
            getMaterialData();
            getFinshGoodsData();
            getLiveData();
            getModelData();
            getproduceRateData();
            getMidData();
        }, 60000);
    </script>

</body>

</html>